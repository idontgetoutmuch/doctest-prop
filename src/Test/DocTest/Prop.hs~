module Test.DocTest.Prop
       (prop, propWith, quietArgs, unit) where

{-|

This package allows you to write QuickCheck properties within doctest,
by keeping silence when test succeeds and printing out the test
outputs otherwise.

>>> import Test.DocTest.Prop

-}

import Test.QuickCheck

-- | The standard arguments for QuickCheck but the chatty flag is off.
quietArgs :: Args
quietArgs = stdArgs {chatty = False}

-- | Test the QuickCheck property.
prop :: Testable p => p -> IO ()
prop p = do
  r <- quickCheckWithResult quietArgs p
  case r of
    Success _ _ _ -> return ()
    _ -> putStrLn $ output r

-- | @prop@ with customized arguments.
propWith :: Testable p => Args -> p -> IO ()
propWith args p = do
  r <- quickCheckWithResult args  p
  case r of
    Success _ _ _ -> return ()
    _ -> putStrLn $ output r

-- | Test for an unchanging property.
unit :: Bool -> IO ()
unit True  = return ()
unit False = putStrLn "Failure"